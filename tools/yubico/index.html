<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="My technical knowledge collection is here."><meta name=author content="Ivan K"><link href=https://ivankatliarchuk.github.io/tools/yubico/ rel=canonical><link href=../website.tools/ rel=prev><link href=../aws/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.14"><title>yubico - IvanK public knowledge base</title><link rel=stylesheet href=../../assets/stylesheets/main.10ba22f1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=deep-orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#configuring-and-using-the-yubikey class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="IvanK public knowledge base" class="md-header__button md-logo" aria-label="IvanK public knowledge base" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> IvanK public knowledge base </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> yubico </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ivankatliarchuk/knowledge-base title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../blogs/blogs.web-to-follow/ class=md-tabs__link> Blogs&Articles </a> </li> <li class=md-tabs__item> <a href=../../education/ class=md-tabs__link> Education </a> </li> <li class=md-tabs__item> <a href=../../interview/ class=md-tabs__link> Interview </a> </li> <li class=md-tabs__item> <a href=../../leadership/ class=md-tabs__link> Leadership </a> </li> <li class=md-tabs__item> <a href=../../sre-platform-devops/ class=md-tabs__link> SRE-Platform-DevOps </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Tools </a> </li> <li class=md-tabs__item> <a href=../../travel/ class=md-tabs__link> Properties&Travel </a> </li> <li class=md-tabs__item> <a href=../../ideas/ class=md-tabs__link> Companies&Ideas </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="IvanK public knowledge base" class="md-nav__button md-logo" aria-label="IvanK public knowledge base" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> IvanK public knowledge base </label> <div class=md-nav__source> <a href=https://github.com/ivankatliarchuk/knowledge-base title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Home </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../quicklinks/ class=md-nav__link> <span class=md-ellipsis> Quick Links </span> </a> </li> <li class=md-nav__item> <a href=../../awesome-pages/ class=md-nav__link> <span class=md-ellipsis> Awesome Pages </span> </a> </li> <li class=md-nav__item> <a href=../../tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Blogs&Articles </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blogs&Articles </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex=0> <span class=md-ellipsis> Blogs </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Blogs </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blogs/blogs.web-to-follow/ class=md-nav__link> <span class=md-ellipsis> blogs to follow </span> </a> </li> <li class=md-nav__item> <a href=../../blogs/coding/ class=md-nav__link> <span class=md-ellipsis> coding blogs </span> </a> </li> <li class=md-nav__item> <a href=../../blogs/how-to/ class=md-nav__link> <span class=md-ellipsis> how to </span> </a> </li> <li class=md-nav__item> <a href=../../blogs/kubernetes/ class=md-nav__link> <span class=md-ellipsis> kubernetes </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Education </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Education </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_1> <div class="md-nav__link md-nav__container"> <a href=../../education/ class="md-nav__link "> <span class=md-ellipsis> Education </span> </a> <label class="md-nav__link " for=__nav_3_1 id=__nav_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> Education </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../education/android/ class=md-nav__link> <span class=md-ellipsis> android cofing </span> </a> </li> <li class=md-nav__item> <a href=../../education/certifications/ class=md-nav__link> <span class=md-ellipsis> cyber security certifications </span> </a> </li> <li class=md-nav__item> <a href=../../education/courses.tutorials/ class=md-nav__link> <span class=md-ellipsis> courses and tutorials </span> </a> </li> <li class=md-nav__item> <a href=../../education/markdown-tricks/ class=md-nav__link> <span class=md-ellipsis> markdown tricks </span> </a> </li> <li class=md-nav__item> <a href=../../education/mentorship/ class=md-nav__link> <span class=md-ellipsis> mentorship </span> </a> </li> <li class=md-nav__item> <a href=../../education/resources/ class=md-nav__link> <span class=md-ellipsis> education resources & lists </span> </a> </li> <li class=md-nav__item> <a href=../../education/talks-and-conferences/ class=md-nav__link> <span class=md-ellipsis> talks and conferences </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__container"> <a href=../../workshops/ class="md-nav__link "> <span class=md-ellipsis> Workshops </span> </a> <label class="md-nav__link " for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Workshops </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../workshops/ecs/ class=md-nav__link> <span class=md-ellipsis> cloud general </span> </a> </li> <li class=md-nav__item> <a href=../../workshops/k8s-security/ class=md-nav__link> <span class=md-ellipsis> k8s security </span> </a> </li> <li class=md-nav__item> <a href=../../workshops/k8s/ class=md-nav__link> <span class=md-ellipsis> k8s general </span> </a> </li> <li class=md-nav__item> <a href=../../workshops/pentest/ class=md-nav__link> <span class=md-ellipsis> pentest </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Interview </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Interview </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4_1> <div class="md-nav__link md-nav__container"> <a href=../../interview/ class="md-nav__link "> <span class=md-ellipsis> Interview </span> </a> <label class="md-nav__link " for=__nav_4_1 id=__nav_4_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Interview </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../interview/code-review/ class=md-nav__link> <span class=md-ellipsis> code-review </span> </a> </li> <li class=md-nav__item> <a href=../../interview/hypotetical/ class=md-nav__link> <span class=md-ellipsis> hypothetical questions </span> </a> </li> <li class=md-nav__item> <a href=../../interview/interview-steps/ class=md-nav__link> <span class=md-ellipsis> interview </span> </a> </li> <li class=md-nav__item> <a href=../../interview/request-pay-rise/ class=md-nav__link> <span class=md-ellipsis> code-review </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Leadership </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Leadership </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_1> <div class="md-nav__link md-nav__container"> <a href=../../leadership/ class="md-nav__link "> <span class=md-ellipsis> Leadership </span> </a> <label class="md-nav__link " for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> Leadership </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../leadership/phrases/ class=md-nav__link> <span class=md-ellipsis> phrases </span> </a> </li> <li class=md-nav__item> <a href=../../leadership/questions/ class=md-nav__link> <span class=md-ellipsis> questions </span> </a> </li> <li class=md-nav__item> <a href=../../leadership/words/ class=md-nav__link> <span class=md-ellipsis> Words </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class=md-ellipsis> Job Descriptions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Job Descriptions </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_2_1> <label class=md-nav__link for=__nav_5_2_1 id=__nav_5_2_1_label tabindex=0> <span class=md-ellipsis> Job description </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2_1> <span class="md-nav__icon md-icon"></span> Job description </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../leadership/job-description/devsecops/ class=md-nav__link> <span class=md-ellipsis> EM security and zero trust </span> </a> </li> <li class=md-nav__item> <a href=../../leadership/job-description/platform-engineer/ class=md-nav__link> <span class=md-ellipsis> job advert </span> </a> </li> <li class=md-nav__item> <a href=../../leadership/job-description/take-home-tasks/ class=md-nav__link> <span class=md-ellipsis> take home tasks </span> </a> </li> <li class=md-nav__item> <a href=../../leadership/job-description/tech-competency/ class=md-nav__link> <span class=md-ellipsis> job </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> <span class=md-ellipsis> Product </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> Product </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_3_1> <div class="md-nav__link md-nav__container"> <a href=../../leadership/product/ class="md-nav__link "> <span class=md-ellipsis> Product </span> </a> <label class="md-nav__link " for=__nav_5_3_1 id=__nav_5_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3_1> <span class="md-nav__icon md-icon"></span> Product </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../leadership/product/agile.practices/ class=md-nav__link> <span class=md-ellipsis> agile practices </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> <span class=md-ellipsis> Career </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> Career </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5_4_1> <label class=md-nav__link for=__nav_5_4_1 id=__nav_5_4_1_label tabindex=0> <span class=md-ellipsis> Career </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4_1> <span class="md-nav__icon md-icon"></span> Career </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../leadership/career/21-management-tips/ class=md-nav__link> <span class=md-ellipsis> 21 people management tips </span> </a> </li> <li class=md-nav__item> <a href=../../leadership/career/career-framerowrks/ class=md-nav__link> <span class=md-ellipsis> Career Frameworks </span> </a> </li> <li class=md-nav__item> <a href=../../leadership/career/engineering-management/ class=md-nav__link> <span class=md-ellipsis> enginnering management </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> SRE-Platform-DevOps </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> SRE-Platform-DevOps </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_1> <div class="md-nav__link md-nav__container"> <a href=../../sre-platform-devops/ class="md-nav__link "> <span class=md-ellipsis> Sre platform devops </span> </a> <label class="md-nav__link " for=__nav_6_1 id=__nav_6_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1> <span class="md-nav__icon md-icon"></span> Sre platform devops </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sre-platform-devops/architecture-bp/ class=md-nav__link> <span class=md-ellipsis> arcthitecture & best practices </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/awesome/ class=md-nav__link> <span class=md-ellipsis> awesome pages </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/companies/ class=md-nav__link> <span class=md-ellipsis> devops companies </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/devops-cheatsheets/ class=md-nav__link> <span class=md-ellipsis> cheat sheets </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/distaster-recovery/ class=md-nav__link> <span class=md-ellipsis> Disaster Recovery </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/how-to/ class=md-nav__link> <span class=md-ellipsis> how to </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/monitoring/ class=md-nav__link> <span class=md-ellipsis> monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/ops-lessons/ class=md-nav__link> <span class=md-ellipsis> operation lessons </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/os/ class=md-nav__link> <span class=md-ellipsis> os </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> <span class=md-ellipsis> Notes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_2_1> <div class="md-nav__link md-nav__container"> <a href=../../sre-platform-devops/notes/ class="md-nav__link "> <span class=md-ellipsis> Notes </span> </a> <label class="md-nav__link " for=__nav_6_2_1 id=__nav_6_2_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2_1> <span class="md-nav__icon md-icon"></span> Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sre-platform-devops/notes/google/ class=md-nav__link> <span class=md-ellipsis> google notes </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_3> <label class=md-nav__link for=__nav_6_3 id=__nav_6_3_label tabindex=0> <span class=md-ellipsis> Run Books </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3> <span class="md-nav__icon md-icon"></span> Run Books </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_3_1> <div class="md-nav__link md-nav__container"> <a href=../../sre-platform-devops/run-books/ class="md-nav__link "> <span class=md-ellipsis> Run books </span> </a> <label class="md-nav__link " for=__nav_6_3_1 id=__nav_6_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_3_1> <span class="md-nav__icon md-icon"></span> Run books </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sre-platform-devops/run-books/declaring-incident/ class=md-nav__link> <span class=md-ellipsis> declaring incident (CMOC) </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/run-books/engineer-on-call/ class=md-nav__link> <span class=md-ellipsis> engineer on call (EOC) </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/run-books/gitlab-oncall-run-book/ class=md-nav__link> <span class=md-ellipsis> gitlab on call run book </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_4> <label class=md-nav__link for=__nav_6_4 id=__nav_6_4_label tabindex=0> <span class=md-ellipsis> Readiness Lists </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4> <span class="md-nav__icon md-icon"></span> Readiness Lists </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_4_1> <div class="md-nav__link md-nav__container"> <a href=../../sre-platform-devops/check-lists/ class="md-nav__link "> <span class=md-ellipsis> Check lists </span> </a> <label class="md-nav__link " for=__nav_6_4_1 id=__nav_6_4_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_4_1> <span class="md-nav__icon md-icon"></span> Check lists </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/android-app-checklist/ class=md-nav__link> <span class=md-ellipsis> android app launch checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/app-migration-process/ class=md-nav__link> <span class=md-ellipsis> application migration process </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/app-readiness-checklist/ class=md-nav__link> <span class=md-ellipsis> application readiness checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/assessing-migration-readiness/ class=md-nav__link> <span class=md-ellipsis> assessing migration readiness </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/incident-response-phases/ class=md-nav__link> <span class=md-ellipsis> incident readiness phases </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/incident-response-plan/ class=md-nav__link> <span class=md-ellipsis> incident readiness plan </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/incident-response-post/ class=md-nav__link> <span class=md-ellipsis> post-incident review checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/infrastructure-forensic-readiness/ class=md-nav__link> <span class=md-ellipsis> aws cloud readiness checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/k8s-best-pratices-checklist/ class=md-nav__link> <span class=md-ellipsis> kubernetes best practices checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/lunch-coordination/ class=md-nav__link> <span class=md-ellipsis> launch coordination checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/monitoring-list/ class=md-nav__link> <span class=md-ellipsis> monitorin readiness lists </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/operations-metrics/ class=md-nav__link> <span class=md-ellipsis> operations readiness metrics lists </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/oreily-list/ class=md-nav__link> <span class=md-ellipsis> oreilly readiness checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/release-checklist/ class=md-nav__link> <span class=md-ellipsis> release checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/technical-diagrams-checklist/ class=md-nav__link> <span class=md-ellipsis> application documentation checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/vault-checklist/ class=md-nav__link> <span class=md-ellipsis> vault checklist </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/vulnerability.list/ class=md-nav__link> <span class=md-ellipsis> vulnerability list </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/check-lists/website-scan-checklist/ class=md-nav__link> <span class=md-ellipsis> website scan checklist </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_5> <label class=md-nav__link for=__nav_6_5 id=__nav_6_5_label tabindex=0> <span class=md-ellipsis> Architecture Notes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5> <span class="md-nav__icon md-icon"></span> Architecture Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_5_1> <label class=md-nav__link for=__nav_6_5_1 id=__nav_6_5_1_label tabindex=0> <span class=md-ellipsis> Architecture notes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_5_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_5_1> <span class="md-nav__icon md-icon"></span> Architecture notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sre-platform-devops/architecture-notes/audits/ class=md-nav__link> <span class=md-ellipsis> audits documentation </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/architecture-notes/design-data/ class=md-nav__link> <span class=md-ellipsis> system data design </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/architecture-notes/documentation/ class=md-nav__link> <span class=md-ellipsis> documentation architecture </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/architecture-notes/microservice-lifecycle/ class=md-nav__link> <span class=md-ellipsis> high level system design </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/architecture-notes/references-architecture/ class=md-nav__link> <span class=md-ellipsis> reference architecture </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_6> <div class="md-nav__link md-nav__container"> <a href=../../sre-platform-devops/infrastructure/ class="md-nav__link "> <span class=md-ellipsis> Infrastructure </span> </a> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_6> <span class="md-nav__icon md-icon"></span> Infrastructure </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_7> <label class=md-nav__link for=__nav_6_7 id=__nav_6_7_label tabindex=0> <span class=md-ellipsis> Docs Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_7_label aria-expanded=false> <label class=md-nav__title for=__nav_6_7> <span class="md-nav__icon md-icon"></span> Docs Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6_7_1> <label class=md-nav__link for=__nav_6_7_1 id=__nav_6_7_1_label tabindex=0> <span class=md-ellipsis> Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_7_1_label aria-expanded=false> <label class=md-nav__title for=__nav_6_7_1> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../sre-platform-devops/examples/incident-state-document/ class=md-nav__link> <span class=md-ellipsis> Incident state document </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/examples/info/ class=md-nav__link> <span class=md-ellipsis> Postmortem Practices </span> </a> </li> <li class=md-nav__item> <a href=../../sre-platform-devops/examples/postmortem/ class=md-nav__link> <span class=md-ellipsis> Incident state document </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7 checked> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex> <span class=md-ellipsis> Tools </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=true> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_1 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Tools </span> </a> <label class="md-nav__link " for=__nav_7_1 id=__nav_7_1_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_1_label aria-expanded=true> <label class=md-nav__title for=__nav_7_1> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../agile.tools/ class=md-nav__link> <span class=md-ellipsis> agile&diagrams </span> </a> </li> <li class=md-nav__item> <a href=../audit/ class=md-nav__link> <span class=md-ellipsis> audit tooling </span> </a> </li> <li class=md-nav__item> <a href=../authentication/ class=md-nav__link> <span class=md-ellipsis> authentication </span> </a> </li> <li class=md-nav__item> <a href=../blueprints/ class=md-nav__link> <span class=md-ellipsis> project blueprints </span> </a> </li> <li class=md-nav__item> <a href=../bots/ class=md-nav__link> <span class=md-ellipsis> bots </span> </a> </li> <li class=md-nav__item> <a href=../cicd/ class=md-nav__link> <span class=md-ellipsis> cicd tooling </span> </a> </li> <li class=md-nav__item> <a href=../coding/ class=md-nav__link> <span class=md-ellipsis> coding tooling </span> </a> </li> <li class=md-nav__item> <a href=../company.tools/ class=md-nav__link> <span class=md-ellipsis> company tooling </span> </a> </li> <li class=md-nav__item> <a href=../database/ class=md-nav__link> <span class=md-ellipsis> database tooling </span> </a> </li> <li class=md-nav__item> <a href=../github/ class=md-nav__link> <span class=md-ellipsis> github </span> </a> </li> <li class=md-nav__item> <a href=../infrastructure/ class=md-nav__link> <span class=md-ellipsis> infrastructure tooling </span> </a> </li> <li class=md-nav__item> <a href=../metrics/ class=md-nav__link> <span class=md-ellipsis> metrics tooling </span> </a> </li> <li class=md-nav__item> <a href=../monitoring/ class=md-nav__link> <span class=md-ellipsis> monitoring tools </span> </a> </li> <li class=md-nav__item> <a href=../networking/ class=md-nav__link> <span class=md-ellipsis> networking </span> </a> </li> <li class=md-nav__item> <a href=../office/ class=md-nav__link> <span class=md-ellipsis> day&office planners </span> </a> </li> <li class=md-nav__item> <a href=../os/ class=md-nav__link> <span class=md-ellipsis> install os </span> </a> </li> <li class=md-nav__item> <a href=../performance/ class=md-nav__link> <span class=md-ellipsis> performance tooling </span> </a> </li> <li class=md-nav__item> <a href=../platforms/ class=md-nav__link> <span class=md-ellipsis> platform engineering </span> </a> </li> <li class=md-nav__item> <a href=../resources/ class=md-nav__link> <span class=md-ellipsis> blogging resources </span> </a> </li> <li class=md-nav__item> <a href=../secrets-management/ class=md-nav__link> <span class=md-ellipsis> secrets management </span> </a> </li> <li class=md-nav__item> <a href=../sre/ class=md-nav__link> <span class=md-ellipsis> sre </span> </a> </li> <li class=md-nav__item> <a href=../terraform%26terragrunt/ class=md-nav__link> <span class=md-ellipsis> terraform </span> </a> </li> <li class=md-nav__item> <a href=../unix/ class=md-nav__link> <span class=md-ellipsis> unix&linux tooling </span> </a> </li> <li class=md-nav__item> <a href=../website.tools/ class=md-nav__link> <span class=md-ellipsis> website tooling </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> yubico </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> yubico </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#initial-configuration class=md-nav__link> <span class=md-ellipsis> Initial configuration </span> </a> <nav class=md-nav aria-label="Initial configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-requirements class=md-nav__link> <span class=md-ellipsis> 1. Requirements </span> </a> </li> <li class=md-nav__item> <a href=#2-change-the-default-pin-entries class=md-nav__link> <span class=md-ellipsis> 2. Change the default PIN entries </span> </a> </li> <li class=md-nav__item> <a href=#3-create-a-secure-storage-for-the-master-key class=md-nav__link> <span class=md-ellipsis> 3. Create a secure storage for the Master Key </span> </a> </li> <li class=md-nav__item> <a href=#4-create-master-key class=md-nav__link> <span class=md-ellipsis> 4. Create Master Key </span> </a> </li> <li class=md-nav__item> <a href=#5-create-subkeys class=md-nav__link> <span class=md-ellipsis> 5. Create Subkeys </span> </a> </li> <li class=md-nav__item> <a href=#6-backup-your-public-key class=md-nav__link> <span class=md-ellipsis> 6. Backup your Public Key </span> </a> </li> <li class=md-nav__item> <a href=#7-import-public-key-to-regular-keychain class=md-nav__link> <span class=md-ellipsis> 7. Import Public Key to Regular Keychain </span> </a> </li> <li class=md-nav__item> <a href=#8-copy-the-gpgconf-settings-you-need class=md-nav__link> <span class=md-ellipsis> 8. Copy the gpg.conf settings you need </span> </a> </li> <li class=md-nav__item> <a href=#9-ensure-proper-options-are-set-in-gpg-agentconf class=md-nav__link> <span class=md-ellipsis> 9. Ensure proper options are set in gpg-agent.conf </span> </a> </li> <li class=md-nav__item> <a href=#12-script-to-reset-gpg-agent-and-ssh-agent class=md-nav__link> <span class=md-ellipsis> 12. Script to Reset gpg-agent and ssh-agent </span> </a> </li> <li class=md-nav__item> <a href=#13-export-your-ssh-public-key class=md-nav__link> <span class=md-ellipsis> 13. Export Your SSH Public Key </span> </a> </li> <li class=md-nav__item> <a href=#14-use-your-gpg-public-key-to-sign-git-commits class=md-nav__link> <span class=md-ellipsis> 14. Use your GPG Public Key to Sign Git Commits </span> </a> </li> <li class=md-nav__item> <a href=#15-testing class=md-nav__link> <span class=md-ellipsis> 15. Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cleanup class=md-nav__link> <span class=md-ellipsis> Cleanup </span> </a> </li> <li class=md-nav__item> <a href=#maintenance class=md-nav__link> <span class=md-ellipsis> Maintenance </span> </a> <nav class=md-nav aria-label=Maintenance> <ul class=md-nav__list> <li class=md-nav__item> <a href=#renew-expiring-subkeys class=md-nav__link> <span class=md-ellipsis> Renew expiring subkeys </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gpg-cannot-find-the-yubikey class=md-nav__link> <span class=md-ellipsis> GPG cannot find the Yubikey </span> </a> </li> <li class=md-nav__item> <a href=#ssh-connections-hang class=md-nav__link> <span class=md-ellipsis> ssh connections hang </span> </a> </li> <li class=md-nav__item> <a href=#unable-to-sign-commits-with-backup-yubikey class=md-nav__link> <span class=md-ellipsis> Unable to sign commits with backup YubiKey </span> </a> </li> <li class=md-nav__item> <a href=#resetting-your-yubikey class=md-nav__link> <span class=md-ellipsis> Resetting your yubikey </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#linux-tips class=md-nav__link> <span class=md-ellipsis> Linux tips </span> </a> <nav class=md-nav aria-label="Linux tips"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gpg-selecting-openpgp-failed-no-such-device class=md-nav__link> <span class=md-ellipsis> gpg: selecting openpgp failed: No such device </span> </a> </li> <li class=md-nav__item> <a href=#linux-mint-gtk2-pinentry class=md-nav__link> <span class=md-ellipsis> Linux Mint (GTK2) + Pinentry </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#reference-material class=md-nav__link> <span class=md-ellipsis> Reference Material </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_2> <label class=md-nav__link for=__nav_7_2 id=__nav_7_2_label tabindex> <span class=md-ellipsis> AWS </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> AWS </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_2_1> <div class="md-nav__link md-nav__container"> <a href=../aws/ class="md-nav__link "> <span class=md-ellipsis> Aws </span> </a> <label class="md-nav__link " for=__nav_7_2_1 id=__nav_7_2_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_2_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2_1> <span class="md-nav__icon md-icon"></span> Aws </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../aws/clouds/ class=md-nav__link> <span class=md-ellipsis> resource management </span> </a> </li> <li class=md-nav__item> <a href=../aws/eks/ class=md-nav__link> <span class=md-ellipsis> eks tooling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_3> <label class=md-nav__link for=__nav_7_3 id=__nav_7_3_label tabindex> <span class=md-ellipsis> Cyber-Sec </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> Cyber-Sec </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_3_1> <div class="md-nav__link md-nav__container"> <a href=../cyber-sec/ class="md-nav__link "> <span class=md-ellipsis> Cyber sec </span> </a> <label class="md-nav__link " for=__nav_7_3_1 id=__nav_7_3_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_3_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3_1> <span class="md-nav__icon md-icon"></span> Cyber sec </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cyber-sec/offsec/ class=md-nav__link> <span class=md-ellipsis> offsec tooling </span> </a> </li> <li class=md-nav__item> <a href=../cyber-sec/pentest/ class=md-nav__link> <span class=md-ellipsis> pentest tooling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_4> <label class=md-nav__link for=__nav_7_4 id=__nav_7_4_label tabindex> <span class=md-ellipsis> Kubernetes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_4_label aria-expanded=false> <label class=md-nav__title for=__nav_7_4> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_4_1> <div class="md-nav__link md-nav__container"> <a href=../kubernetes/ class="md-nav__link "> <span class=md-ellipsis> Kubernetes </span> </a> <label class="md-nav__link " for=__nav_7_4_1 id=__nav_7_4_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_7_4_1_label aria-expanded=false> <label class=md-nav__title for=__nav_7_4_1> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../kubernetes/helm-charts/ class=md-nav__link> <span class=md-ellipsis> helm tooling </span> </a> </li> <li class=md-nav__item> <a href=../kubernetes/k8s-operators/ class=md-nav__link> <span class=md-ellipsis> k8s operators and controllers </span> </a> </li> <li class=md-nav__item> <a href=../kubernetes/k8s-tests/ class=md-nav__link> <span class=md-ellipsis> k8s tooling </span> </a> </li> <li class=md-nav__item> <a href=../kubernetes/k8s/ class=md-nav__link> <span class=md-ellipsis> k8s tooling </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <div class="md-nav__link md-nav__container"> <a href=../../travel/ class="md-nav__link "> <span class=md-ellipsis> Properties&Travel </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Properties&Travel </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_9> <div class="md-nav__link md-nav__container"> <a href=../../ideas/ class="md-nav__link "> <span class=md-ellipsis> Companies&Ideas </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_9_label aria-expanded=false> <label class=md-nav__title for=__nav_9> <span class="md-nav__icon md-icon"></span> Companies&Ideas </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <nav class=md-tags> <a href=../../tags/#tools class=md-tag>tools</a> <a href=../../tags/#yubico class=md-tag>yubico</a> </nav> <h1 id=configuring-and-using-the-yubikey>Configuring and Using the Yubikey<a class=headerlink href=#configuring-and-using-the-yubikey title="Permanent link">#</a></h1> <p>The following setup enables us to use the YubiKey with OpenPGP, the Authentication subkey <a href=https://developers.yubico.com/PGP/SSH_authentication/ >as an SSH key</a> and the Encryption subkey to sign Git commits.</p> <h2 id=initial-configuration>Initial configuration<a class=headerlink href=#initial-configuration title="Permanent link">#</a></h2> <p>If you find any problems during the setup, take a look at the <a href=#troubleshooting>troubleshooting</a> section at the end of this document.</p> <h3 id=1-requirements>1. Requirements<a class=headerlink href=#1-requirements title="Permanent link">#</a></h3> <p> <details> <summary>Linux</summary> * `gpg2` <div class=highlight><pre><span></span><code>sudo apt-get install gnupg2
</code></pre></div> Lets create an alias so that we can use `gpg` instead of using `gpg2` all the time: <div class=highlight><pre><span></span><code>echo &quot;alias gpg=&#39;gpg2&#39;&quot; &gt;&gt; ~/.bashrc
</code></pre></div> * `scdaemon` <div class=highlight><pre><span></span><code>sudo apt-get install scdaemon
</code></pre></div> * For Yubikey 4 **only** -> `yubikey-personalization` <div class=highlight><pre><span></span><code>sudo apt-get install yubikey-personalization
</code></pre></div> Yubikey 4 does not come with all modules enabled. This setting lets us use the Yubikey as both a SmartCard and an OTP device at the same time. <div class=highlight><pre><span></span><code>ykpersonalize<span class=w> </span>-m86
</code></pre></div> This setting lets us use the Yubikey as both a SmartCard and an OTP device at the same time. * For Yubikey 5 **only** -> ykman. On Linux the pkg name is `yubikey-manager`. <div class=highlight><pre><span></span><code>sudo apt-get install yubikey-manager
</code></pre></div> `ykman` manual can be found [online](https://support.yubico.com/hc/en-us/articles/360016614940-YubiKey-Manager-CLI-ykman-User-Manual) </details> </p> <p> <details> <summary>MacOS</summary> * `gpg2` <div class=highlight><pre><span></span><code>brew install gnupg
</code></pre></div> * For Yubikey 4 **only** -> `yubikey-personalization` <div class=highlight><pre><span></span><code>brew install yubikey-personalization
</code></pre></div> Yubikey 4 does not come with all modules enabled. This setting lets us use the Yubikey as both a SmartCard and an OTP device at the same time. <div class=highlight><pre><span></span><code>ykpersonalize<span class=w> </span>-m86
</code></pre></div> This setting lets us use the Yubikey as both a SmartCard and an OTP device at the same time. * For Yubikey 5 **only** -> `ykman` <div class=highlight><pre><span></span><code>brew install ykman
</code></pre></div> `ykman` manual can be found [online](https://support.yubico.com/hc/en-us/articles/360016614940-YubiKey-Manager-CLI-ykman-User-Manual) * For graphical pin-entry on MacOS install the brew package `pinentry-mac` <div class=highlight><pre><span></span><code>brew<span class=w> </span>install<span class=w> </span>pinentry-mac
</code></pre></div> </details> </p> <h3 id=2-change-the-default-pin-entries>2. Change the default PIN entries<a class=headerlink href=#2-change-the-default-pin-entries title="Permanent link">#</a></h3> <p>The yubikey comes pre-configured with a set of default PINs that we need to change. By default the user PIN is <code>123456</code> and the ADMIN PIN is <code>12345678</code>.</p> <p> <details> <summary>How to change the default pin entries</summary> The `unlock pin` is what you will use most of the time for confirming access via the keys stored on the Yubikey. <div class=highlight><pre><span></span><code>&gt;<span class=w> </span>gpg<span class=w> </span>--card-edit

Application<span class=w> </span>ID<span class=w> </span>...:<span class=w> </span>D2760001240102000006123482780000
Version<span class=w> </span>..........:<span class=w> </span><span class=m>2</span>.1
Manufacturer<span class=w> </span>.....:<span class=w> </span>Yubico
Serial<span class=w> </span>number<span class=w> </span>....:<span class=w> </span><span class=m>12345678</span>
Name<span class=w> </span>of<span class=w> </span>cardholder:<span class=w> </span><span class=o>[</span>not<span class=w> </span>set<span class=o>]</span>
Language<span class=w> </span>prefs<span class=w> </span>...:<span class=w> </span><span class=o>[</span>not<span class=w> </span>set<span class=o>]</span>
Sex<span class=w> </span>..............:<span class=w> </span>unspecified
URL<span class=w> </span>of<span class=w> </span>public<span class=w> </span>key<span class=w> </span>:<span class=w> </span><span class=o>[</span>not<span class=w> </span>set<span class=o>]</span>
Login<span class=w> </span>data<span class=w> </span>.......:<span class=w> </span><span class=o>[</span>not<span class=w> </span>set<span class=o>]</span>
Signature<span class=w> </span>PIN<span class=w> </span>....:<span class=w> </span>not<span class=w> </span>forced
Key<span class=w> </span>attributes<span class=w> </span>...:<span class=w> </span><span class=o>[</span>none<span class=o>]</span>
Max.<span class=w> </span>PIN<span class=w> </span>lengths<span class=w> </span>.:<span class=w> </span><span class=m>127</span><span class=w> </span><span class=m>127</span><span class=w> </span><span class=m>127</span>
PIN<span class=w> </span>retry<span class=w> </span>counter<span class=w> </span>:<span class=w> </span><span class=m>3</span><span class=w> </span><span class=m>3</span><span class=w> </span><span class=m>3</span>
Signature<span class=w> </span>counter<span class=w> </span>:<span class=w> </span><span class=m>2</span>
Signature<span class=w> </span>key<span class=w> </span>....:<span class=w> </span><span class=o>[</span>none<span class=o>]</span>
Encryption<span class=w> </span>key....:<span class=w> </span><span class=o>[</span>none<span class=o>]</span>
Authentication<span class=w> </span>key:<span class=w> </span><span class=o>[</span>none<span class=o>]</span>
General<span class=w> </span>key<span class=w> </span>info..:<span class=w> </span><span class=o>[</span>none<span class=o>]</span>

gpg/card&gt;<span class=w> </span>admin
Admin<span class=w> </span>commands<span class=w> </span>are<span class=w> </span>allowed

<span class=c1># Enable Key Derived Format for secure PIN entry</span>
gpg/card&gt;<span class=w> </span>kdf-setup

<span class=c1># Change the PIN and Admin PINs</span>
<span class=c1># The ADMIN PIN must be at least 8 characters in length otherwise it&#39;ll silently fail, and you&#39;ll need to reset your yubikey</span>
<span class=c1># The USER PIN presumably has similar restrictions, so make sure it&#39;s at least 6 characters in length</span>

gpg/card&gt;<span class=w> </span>passwd
gpg:<span class=w> </span>OpenPGP<span class=w> </span>card<span class=w> </span>no.<span class=w> </span>D2760001240102000006123482780000<span class=w> </span>detected

<span class=m>1</span><span class=w> </span>-<span class=w> </span>change<span class=w> </span>PIN
<span class=m>2</span><span class=w> </span>-<span class=w> </span>unblock<span class=w> </span>PIN
<span class=m>3</span><span class=w> </span>-<span class=w> </span>change<span class=w> </span>Admin<span class=w> </span>PIN
<span class=m>4</span><span class=w> </span>-<span class=w> </span><span class=nb>set</span><span class=w> </span>the<span class=w> </span>Reset<span class=w> </span>Code
Q<span class=w> </span>-<span class=w> </span>quit

Your<span class=w> </span>selection?<span class=w> </span><span class=m>1</span>
PIN<span class=w> </span>changed.

<span class=m>1</span><span class=w> </span>-<span class=w> </span>change<span class=w> </span>PIN
<span class=m>2</span><span class=w> </span>-<span class=w> </span>unblock<span class=w> </span>PIN
<span class=m>3</span><span class=w> </span>-<span class=w> </span>change<span class=w> </span>Admin<span class=w> </span>PIN
<span class=m>4</span><span class=w> </span>-<span class=w> </span><span class=nb>set</span><span class=w> </span>the<span class=w> </span>Reset<span class=w> </span>Code
Q<span class=w> </span>-<span class=w> </span>quit

Your<span class=w> </span>selection?<span class=w> </span><span class=m>3</span>
PIN<span class=w> </span>changed.

<span class=m>1</span><span class=w> </span>-<span class=w> </span>change<span class=w> </span>PIN
<span class=m>2</span><span class=w> </span>-<span class=w> </span>unblock<span class=w> </span>PIN
<span class=m>3</span><span class=w> </span>-<span class=w> </span>change<span class=w> </span>Admin<span class=w> </span>PIN
<span class=m>4</span><span class=w> </span>-<span class=w> </span><span class=nb>set</span><span class=w> </span>the<span class=w> </span>Reset<span class=w> </span>Code
Q<span class=w> </span>-<span class=w> </span>quit

Your<span class=w> </span>selection?<span class=w> </span>q

<span class=c1># Make sure the PIN is entered before signing</span>
gpg/card&gt;<span class=w> </span>forcesig

gpg/card&gt;<span class=w> </span>quit
</code></pre></div> </details> </p> <h3 id=3-create-a-secure-storage-for-the-master-key>3. Create a secure storage for the Master Key<a class=headerlink href=#3-create-a-secure-storage-for-the-master-key title="Permanent link">#</a></h3> <p>We want to be able to keep a backup of the GPG master key offline, encrypted, and stored in a super-secret-hiding-place. We do this by creating the <code>gpg_config</code> location on a virtual disk that we mount locally. Using this approach:</p> <ul> <li>The virtual disk can be copied to a secure location for recovery (such as on a USB key).</li> <li>The virtual disk has a password and must be mounted locally for access to the gpg_config location by gpg.</li> </ul> <p>To do that:</p> <ol> <li> <p>Create an encrypted volume</p> <p><p> <details> <summary>MacOS</summary></p> <p>Create an encrypted sparse bundle using MacOS' <code>hdiutil</code>:</p> <div class=highlight><pre><span></span><code>hdiutil<span class=w> </span>create<span class=w> </span>-fs<span class=w> </span>HFS+<span class=w> </span>-layout<span class=w> </span>GPTSPUD<span class=w> </span>-type<span class=w> </span>SPARSEBUNDLE<span class=w> </span>-encryption<span class=w> </span>AES-256<span class=w> </span>-volname<span class=w> </span><span class=s2>&quot;GitLab&quot;</span><span class=w> </span>-size<span class=w> </span>100m<span class=w> </span>-stdinpass<span class=w> </span>~/gitlab.sparsebundle
</code></pre></div> <p>Mount it up:</p> <div class=highlight><pre><span></span><code>hdiutil<span class=w> </span>attach<span class=w> </span>-encryption<span class=w> </span>-stdinpass<span class=w> </span>-mountpoint<span class=w> </span>/Volumes/GitLab<span class=w> </span>~/gitlab.sparsebundle
</code></pre></div> <p></details> </p></p> <p><p> <details> <summary>Linux</summary></p> <p>There are many options for Linux and an obvious option is LUKS (Linux Unified Key Setup-on-disk-format), which most Linux distributions already have installed when using full disk encryption. However, if you want the encrypted disk file to be available on other platforms such as MacOS and Windows, a better option is to use <a href=https://veracrypt.fr>VeraCrypt</a>. The below instructions are based on <strong>VeraCrypt</strong> version 1.23.</p> <p>The actions below are similar to the activities completed above for MacOS.</p> <p>You can either perform the below actions using the <strong>VeraCrypt</strong> UI or by using the CLI:</p> <p>Create volume file</p> <div class=highlight><pre><span></span><code>veracrypt<span class=w> </span>--text<span class=w> </span>--create<span class=w> </span>--encryption<span class=w> </span>AES<span class=w> </span>--hash<span class=w> </span>SHA-512<span class=w> </span>--size<span class=w> </span>100M<span class=w> </span>--volume-type<span class=w> </span>normal<span class=w> </span>--filesystem<span class=w> </span>FAT<span class=w> </span>--keyfiles<span class=w> </span><span class=s2>&quot;&quot;</span><span class=w> </span><span class=nv>$HOME</span>/gitlab_secrets

Enter<span class=w> </span>password:
Re-enter<span class=w> </span>password:
Enter<span class=w> </span>PIM:<span class=w>  </span><span class=o>[</span>Enter<span class=o>]</span>
Please<span class=w> </span><span class=nb>type</span><span class=w> </span>at<span class=w> </span>least<span class=w> </span><span class=m>320</span><span class=w> </span>randomly<span class=w> </span>chosen<span class=w> </span>characters<span class=w> </span>and<span class=w> </span><span class=k>then</span><span class=w> </span>press<span class=w> </span>Enter:
Done:<span class=w> </span><span class=m>100</span>.000%<span class=w>  </span>Speed:<span class=w>   </span><span class=m>31</span><span class=w> </span>MB/s<span class=w>  </span>Left:<span class=w> </span><span class=m>0</span><span class=w> </span>s
The<span class=w> </span>VeraCrypt<span class=w> </span>volume<span class=w> </span>has<span class=w> </span>been<span class=w> </span>successfully<span class=w> </span>created.
</code></pre></div> <p><strong>Note:</strong> The default (just hit Enter) for the PIM is probably fine, but if you want some extra security, put in a custom value. Higher values will take longer to open the vault, lower ones will take less time but be less secure. See <a href=https://www.veracrypt.fr/en/Personal%20Iterations%20Multiplier%20%28PIM%29.html>https://www.veracrypt.fr/en/Personal%20Iterations%20Multiplier%20%28PIM%29.html</a> for further discussion including the default values.</p> <p>Mount the volume</p> <div class=highlight><pre><span></span><code><span class=o>[</span>sudo<span class=o>]</span><span class=w> </span>mkdir<span class=w> </span>-m<span class=w> </span><span class=m>755</span><span class=w> </span>/media/GitLab
veracrypt<span class=w> </span>--text<span class=w> </span>--keyfiles<span class=w> </span><span class=s2>&quot;&quot;</span><span class=w> </span>--protect-hidden<span class=w> </span>no<span class=w> </span><span class=nv>$HOME</span>/gitlab_secrets<span class=w> </span>/media/GitLab

Enter<span class=w> </span>password<span class=w> </span><span class=k>for</span><span class=w> </span>...:
Enter<span class=w> </span>PIM<span class=w> </span><span class=k>for</span><span class=w> </span>...:<span class=w> </span><span class=o>[</span>Enter<span class=o>]</span>
</code></pre></div> <p></details> </p></p> </li> <li> <p>Create a <code>gpg_config</code> inside our volume</p> <p><p> <details> <summary>MacOS</summary></p> <p>Set the mountpoint</p> <div class=highlight><pre><span></span><code><span class=nb>export</span><span class=w> </span><span class=nv>MOUNTPOINT</span><span class=o>=[</span>According<span class=w> </span>to<span class=w> </span>the<span class=w> </span>OS<span class=w> </span>e.g.<span class=w> </span>/media<span class=o>]</span>/GitLab
</code></pre></div> <p>Create the configuration directory where our GnuPG key rings will live:</p> <div class=highlight><pre><span></span><code>mkdir<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config
chmod<span class=w> </span><span class=m>700</span><span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config
</code></pre></div> <p>Export the configuration directory for GnuPG usage:</p> <div class=highlight><pre><span></span><code><span class=nb>export</span><span class=w> </span><span class=nv>GNUPGHOME</span><span class=o>=</span><span class=nv>$MOUNTPOINT</span>/gpg_config
</code></pre></div> <p>Setup the <code>gpg.conf</code> before we create things:</p> <div class=highlight><pre><span></span><code><span class=nb>echo</span><span class=w> </span>default-preference-list<span class=w> </span>SHA512<span class=w> </span>SHA384<span class=w> </span>SHA256<span class=w> </span>SHA224<span class=w> </span>AES256<span class=w> </span>AES192<span class=w> </span>AES<span class=w> </span>CAMELLIA256<span class=w> </span>CAMELLIA192<span class=w> </span>CAMELLIA128<span class=w> </span>TWOFISH<span class=w> </span>&gt;<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/gpg.conf
<span class=nb>echo</span><span class=w> </span>cert-digest-algo<span class=w> </span>SHA512<span class=w> </span>&gt;&gt;<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/gpg.conf
<span class=nb>echo</span><span class=w> </span>use-agent<span class=w> </span>&gt;&gt;<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/gpg.conf
</code></pre></div> <p></details> </p></p> </li> </ol> <h3 id=4-create-master-key>4. Create Master Key<a class=headerlink href=#4-create-master-key title="Permanent link">#</a></h3> <p>For now, will to generate a key without the sign and encrypt capabilities, leaving only the certify capability.</p> <ol> <li> <p>Create a new master key using gpg <p> <details> <summary>How to create a master key using gpg</summary></p> <div class=highlight><pre><span></span><code>&gt;<span class=w> </span>gpg<span class=w> </span>--expert<span class=w> </span>--full-generate-key
Please<span class=w> </span><span class=k>select</span><span class=w> </span>what<span class=w> </span>kind<span class=w> </span>of<span class=w> </span>key<span class=w> </span>you<span class=w> </span>want:
<span class=w>  </span><span class=o>(</span><span class=m>1</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span>and<span class=w> </span>RSA<span class=w> </span><span class=o>(</span>default<span class=o>)</span>
<span class=w>  </span><span class=o>(</span><span class=m>2</span><span class=o>)</span><span class=w> </span>DSA<span class=w> </span>and<span class=w> </span>Elgamal
<span class=w>  </span><span class=o>(</span><span class=m>3</span><span class=o>)</span><span class=w> </span>DSA<span class=w> </span><span class=o>(</span>sign<span class=w> </span>only<span class=o>)</span>
<span class=w>  </span><span class=o>(</span><span class=m>4</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span><span class=o>(</span>sign<span class=w> </span>only<span class=o>)</span>
<span class=w>  </span><span class=o>(</span><span class=m>7</span><span class=o>)</span><span class=w> </span>DSA<span class=w> </span><span class=o>(</span><span class=nb>set</span><span class=w> </span>your<span class=w> </span>own<span class=w> </span>capabilities<span class=o>)</span>
<span class=w>  </span><span class=o>(</span><span class=m>8</span><span class=o>)</span><span class=w> </span>RSA<span class=w> </span><span class=o>(</span><span class=nb>set</span><span class=w> </span>your<span class=w> </span>own<span class=w> </span>capabilities<span class=o>)</span>
Your<span class=w> </span>selection?<span class=w> </span><span class=m>8</span>

Possible<span class=w> </span>actions<span class=w> </span><span class=k>for</span><span class=w> </span>a<span class=w> </span>RSA<span class=w> </span>key:<span class=w> </span>Sign<span class=w> </span>Certify<span class=w> </span>Encrypt<span class=w> </span>Authenticate
Current<span class=w> </span>allowed<span class=w> </span>actions:<span class=w> </span>Sign<span class=w> </span>Certify<span class=w> </span>Encrypt

<span class=w>  </span><span class=o>(</span>S<span class=o>)</span><span class=w> </span>Toggle<span class=w> </span>the<span class=w> </span>sign<span class=w> </span>capability
<span class=w>  </span><span class=o>(</span>E<span class=o>)</span><span class=w> </span>Toggle<span class=w> </span>the<span class=w> </span>encrypt<span class=w> </span>capability
<span class=w>  </span><span class=o>(</span>A<span class=o>)</span><span class=w> </span>Toggle<span class=w> </span>the<span class=w> </span>authenticate<span class=w> </span>capability
<span class=w>  </span><span class=o>(</span>Q<span class=o>)</span><span class=w> </span>Finished

Your<span class=w> </span>selection?<span class=w> </span>s
Your<span class=w> </span>selection?<span class=w> </span>e
Your<span class=w> </span>selection?<span class=w> </span>q

RSA<span class=w> </span>keys<span class=w> </span>may<span class=w> </span>be<span class=w> </span>between<span class=w> </span><span class=m>1024</span><span class=w> </span>and<span class=w> </span><span class=m>4096</span><span class=w> </span>bits<span class=w> </span>long.
What<span class=w> </span>keysize<span class=w> </span><span class=k>do</span><span class=w> </span>you<span class=w> </span>want?<span class=w> </span><span class=o>(</span><span class=m>2048</span><span class=o>)</span><span class=w> </span><span class=m>4096</span>
Requested<span class=w> </span>keysize<span class=w> </span>is<span class=w> </span><span class=m>4096</span><span class=w> </span>bits
Please<span class=w> </span>specify<span class=w> </span>how<span class=w> </span>long<span class=w> </span>the<span class=w> </span>key<span class=w> </span>should<span class=w> </span>be<span class=w> </span>valid.
<span class=w>        </span><span class=nv>0</span><span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>does<span class=w> </span>not<span class=w> </span><span class=nv>expire</span>
<span class=w>        </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>days
<span class=w>      </span><span class=nv>w</span><span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>weeks
<span class=w>      </span><span class=nv>m</span><span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>months
<span class=w>      </span><span class=nv>y</span><span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>years
Key<span class=w> </span>is<span class=w> </span>valid<span class=w> </span><span class=k>for</span>?<span class=w> </span><span class=o>(</span><span class=m>0</span><span class=o>)</span><span class=w> </span>4y
Key<span class=w> </span>expires<span class=w> </span>at<span class=w> </span>Wed<span class=w> </span><span class=m>25</span><span class=w> </span>Aug<span class=w> </span><span class=m>2021</span><span class=w> </span><span class=m>01</span>:45:54<span class=w> </span>AM<span class=w> </span>CST
Is<span class=w> </span>this<span class=w> </span>correct?<span class=w> </span><span class=o>(</span>y/N<span class=o>)</span><span class=w> </span>y

GnuPG<span class=w> </span>needs<span class=w> </span>to<span class=w> </span>construct<span class=w> </span>a<span class=w> </span>user<span class=w> </span>ID<span class=w> </span>to<span class=w> </span>identify<span class=w> </span>your<span class=w> </span>key.

Real<span class=w> </span>name:<span class=w> </span>John<span class=w> </span>Rando
Email<span class=w> </span>address:<span class=w> </span>rando@gitlab.com
Comment:
You<span class=w> </span>selected<span class=w> </span>this<span class=w> </span>USER-ID:
<span class=w>    </span><span class=s2>&quot;John Rando &lt;rando@gitlab.com&gt;&quot;</span>

Change<span class=w> </span><span class=o>(</span>N<span class=o>)</span>ame,<span class=w> </span><span class=o>(</span>C<span class=o>)</span>omment,<span class=w> </span><span class=o>(</span>E<span class=o>)</span>mail<span class=w> </span>or<span class=w> </span><span class=o>(</span>O<span class=o>)</span>kay/<span class=o>(</span>Q<span class=o>)</span>uit?<span class=w> </span>o

public<span class=w> </span>and<span class=w> </span>secret<span class=w> </span>key<span class=w> </span>created<span class=w> </span>and<span class=w> </span>signed.
pub<span class=w>   </span>4096R/FAEFD83E<span class=w> </span><span class=m>2017</span>-08-25<span class=w> </span><span class=o>[</span>expires:<span class=w> </span><span class=m>2021</span>-08-25<span class=o>]</span>
<span class=w>      </span>Key<span class=w> </span><span class=nv>fingerprint</span><span class=w> </span><span class=o>=</span><span class=w> </span>856B<span class=w> </span>1E1C<span class=w> </span>FAD0<span class=w> </span>1FE4<span class=w> </span>5C4C<span class=w>  </span>4E97<span class=w> </span>961F<span class=w> </span>703D<span class=w> </span>B8EF<span class=w> </span>B59D
uid<span class=w>                  </span>John<span class=w> </span>Rando<span class=w> </span>&lt;rando@gitlab.com&gt;
</code></pre></div> <p></details> </p></p> </li> <li> <p>Place a reminder in your calendar in about 3 years 11 months (if you chose 4y lifetime above; adjust as necessary) to extend the expiry of your master key.</p> </li> </ol> <h3 id=5-create-subkeys>5. Create Subkeys<a class=headerlink href=#5-create-subkeys title="Permanent link">#</a></h3> <p>We'll use subkeys that are generated on the Yubikey device itself. Keys generated on the Yubikey cannot be copied off, so loss or destruction of the device will mean key rotation.</p> <p> <details> <summary>How to create a subkeys using gpg</summary> ```shell > gpg --edit-key FAEFD83E # Let's add the SIGNING subkey gpg> addcardkey Signature key ....: [none] Encryption key....: [none] Authentication key: [none] Please select the type of key to generate: (1) Signature key (2) Encryption key (3) Authentication key Your selection? 1 Please specify how long the key should be valid. 0 = key does not expire = key expires in n days w = key expires in n weeks m = key expires in n months y = key expires in n years Key is valid for? (0) 1y Key expires at Sat Aug 25 01:08:14 2018 CST Is this correct? (y/N) y Really create? (y/N) y pub 3072R/FAEFD83E created: 2017-08-25 expires: 2018-08-25 usage: C trust: ultimate validity: ultimate sub 4096R/79BF274F created: 2017-08-25 expires: 2018-08-25 usage: S [ultimate] (1). John Rando <rando@gitlab.com> # Do the same for the ENCRYPTION subkey gpg> addcardkey Signature key ....: 546D 6A7E EB4B 5B07 B3EA 7373 12E2 68AD 79BF 574F Encryption key....: [none] Authentication key: [none] Please select the type of key to generate: (1) Signature key (2) Encryption key (3) Authentication key Your selection? 2 Please specify how long the key should be valid. 0 = key does not expire = key expires in n days w = key expires in n weeks m = key expires in n months y = key expires in n years Key is valid for? (0) 1y Key expires at Sat Aug 25 01:10:41 2018 CST Is this correct? (y/N) y Really create? (y/N) y pub 4096R/FAEFD83E created: 2017-08-25 expires: 2018-08-25 usage: C trust: ultimate validity: ultimate sub 4096R/AE86E89B created: 2017-08-25 expires: 2018-08-25 usage: E sub 4096R/79BF274F created: 2017-08-25 expires: 2018-08-25 usage: S [ultimate] (1). John Rando <rando@gitlab.com> # Do the same for the AUTHENTICATION subkey gpg> addcardkey Signature key ....: 546D 6A7E EB4B 5B07 B3EA 7373 12E2 68AD 79BF 574F Encryption key....: [none] Authentication key: [none] Please select the type of key to generate: (1) Signature key (2) Encryption key (3) Authentication key Your selection? 3 Please specify how long the key should be valid. 0 = key does not expire = key expires in n days w = key expires in n weeks m = key expires in n months y = key expires in n years Key is valid for? (0) 1y Key expires at Sat Aug 25 01:21:41 2018 CST Is this correct? (y/N) y Really create? (y/N) y pub 4096R/FAEFD83E created: 2017-08-25 expires: 2018-08-25 usage: C trust: ultimate validity: ultimate sub 4096R/AE86E89B created: 2017-08-25 expires: 2018-08-25 usage: E sub 4096R/79BF274F created: 2017-08-25 expires: 2018-08-25 usage: S sub 4096R/DE86E396 created: 2017-08-25 expires: 2018-08-25 usage: A [ultimate] (1). John Rando <rando@gitlab.com> # WARNING: Without saving your changes will be lost, all the above would need to be repeated. gpg> save # Make sure the subkeys were created as expected > gpg --list-secret-keys /home/rehab/.gnupg/pubring.kbx ------------------------------ sec# rsa4096 2021-04-09 [C] [expires: 2025-04-08] 3FCA9E1453C08NO887297DBDE61B3B56057B132D uid [ultimate] Rehab Hassanein <rhassanein@gitlab.com> ssb> rsa2048 2021-04-09 [S] [expires: 2022-04-09] ssb> rsa2048 2021-04-09 [E] [expires: 2022-04-09] ssb> rsa2048 2021-04-09 [A] [expires: 2022-04-09] ``` </details> </p> <p><strong>Note:</strong> Certain <code>gpg</code> operations can cause the usage of GPG SmartCards (i.e. the Yubikey) to become "pinned" to a particular gpg-agent instance. This can cause the <code>addcardkey</code> command to fail. If you run into this problem, kill any gpg-agent processes with a different <code>--homedir</code> flag value to your current $GNUPGHOME. Usually, there will be one running with <code>$HOME/.gnupg</code> that is the culprit.</p> <h3 id=6-backup-your-public-key>6. Backup your Public Key<a class=headerlink href=#6-backup-your-public-key title="Permanent link">#</a></h3> <p>If your gpg version does not output the <strong>master</strong> key id you should use the full fingerprint instead.</p> <div class=highlight><pre><span></span><code><span class=c1># To obtain your key fingerprint</span>
gpg<span class=w> </span>--list-key
<span class=c1># example output</span>
<span class=c1>#pub   rsa4096 2021-04-09 [C] [expires: 2025-04-08]</span>
<span class=c1>#     3FCA9E1453C08NO887297DBDE61B3B56057B132D</span>

gpg<span class=w> </span>--armor<span class=w> </span>--export<span class=w> </span>FAEFD83E<span class=w> </span>&gt;<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/FAEFD83E.asc

<span class=c1>#OR</span>

gpg<span class=w> </span>--armor<span class=w> </span>--export<span class=w> </span>3FCA9E1453C08NO887297DBDE61B3B56057B132D<span class=w> </span>&gt;<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/3FCA9E1453C08NO887297DBDE61B3B56057B132D.asc
</code></pre></div> <h3 id=7-import-public-key-to-regular-keychain>7. Import Public Key to Regular Keychain<a class=headerlink href=#7-import-public-key-to-regular-keychain title="Permanent link">#</a></h3> <p>Open up the GPG Keychain app and import the public key that you just created into your regular keychain. Set the Ownertrust to Ultimate on the public key you've imported.</p> <p> <details> <summary>How to import the public key to a regular keychain</summary> In a fresh terminal (i.e. with the default GNUPGHOME env var, not the veracrypt mounted one) we can: <div class=highlight><pre><span></span><code>&gt;<span class=w> </span>gpg<span class=w> </span>--import<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/FAEFD83E.asc
gpg:<span class=w> </span>key<span class=w> </span>FAEFD83E:<span class=w> </span>public<span class=w> </span>key<span class=w> </span>imported
gpg:<span class=w> </span>Total<span class=w> </span>number<span class=w> </span>processed:<span class=w> </span><span class=m>1</span>
gpg:<span class=w>               </span>imported:<span class=w> </span><span class=m>1</span>

&gt;<span class=w> </span>gpg<span class=w> </span>--edit-key<span class=w> </span>FAEFD83E
Secret<span class=w> </span>subkeys<span class=w> </span>are<span class=w> </span>available.

pub<span class=w>  </span>4096R/FAEFD83E<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>C
<span class=w>                    </span>trust:<span class=w> </span>ultimate<span class=w>      </span>validity:<span class=w> </span>ultimate
sub<span class=w>  </span>4096R/AE86E89B<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>E
sub<span class=w>  </span>4096R/79BF274F<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>S
sub<span class=w>  </span>4096R/DE86E396<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>A
<span class=o>[</span>ultimate<span class=o>]</span><span class=w> </span><span class=o>(</span><span class=m>1</span><span class=o>)</span>.<span class=w> </span>John<span class=w> </span>Rando<span class=w> </span>&lt;rando@gitlab.com&gt;

gpg&gt;<span class=w> </span>trust
pub<span class=w>  </span>4096R/FAEFD83E<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>C
<span class=w>                    </span>trust:<span class=w> </span>ultimate<span class=w>      </span>validity:<span class=w> </span>ultimate
sub<span class=w>  </span>4096R/AE86E89B<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>E
sub<span class=w>  </span>4096R/79BF274F<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>S
sub<span class=w>  </span>4096R/DE86E396<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>A
<span class=o>[</span>ultimate<span class=o>]</span><span class=w> </span><span class=o>(</span><span class=m>1</span><span class=o>)</span>.<span class=w> </span>John<span class=w> </span>Rando<span class=w> </span>&lt;rando@gitlab.com&gt;

Please<span class=w> </span>decide<span class=w> </span>how<span class=w> </span>far<span class=w> </span>you<span class=w> </span>trust<span class=w> </span>this<span class=w> </span>user<span class=w> </span>to<span class=w> </span>correctly<span class=w> </span>verify<span class=w> </span>other<span class=w> </span>users<span class=s1>&#39; keys</span>
<span class=s1>(by looking at passports, checking fingerprints from different sources, etc.)</span>

<span class=s1>  1 = I don&#39;</span>t<span class=w> </span>know<span class=w> </span>or<span class=w> </span>won<span class=err>&#39;</span>t<span class=w> </span>say
<span class=w>  </span><span class=nv>2</span><span class=w> </span><span class=o>=</span><span class=w> </span>I<span class=w> </span><span class=k>do</span><span class=w> </span>NOT<span class=w> </span>trust
<span class=w>  </span><span class=nv>3</span><span class=w> </span><span class=o>=</span><span class=w> </span>I<span class=w> </span>trust<span class=w> </span>marginally
<span class=w>  </span><span class=nv>4</span><span class=w> </span><span class=o>=</span><span class=w> </span>I<span class=w> </span>trust<span class=w> </span>fully
<span class=w>  </span><span class=nv>5</span><span class=w> </span><span class=o>=</span><span class=w> </span>I<span class=w> </span>trust<span class=w> </span>ultimately
<span class=w>  </span><span class=nv>m</span><span class=w> </span><span class=o>=</span><span class=w> </span>back<span class=w> </span>to<span class=w> </span>the<span class=w> </span>main<span class=w> </span>menu

Your<span class=w> </span>decision?<span class=w> </span><span class=m>5</span>
Do<span class=w> </span>you<span class=w> </span>really<span class=w> </span>want<span class=w> </span>to<span class=w> </span><span class=nb>set</span><span class=w> </span>this<span class=w> </span>key<span class=w> </span>to<span class=w> </span>ultimate<span class=w> </span>trust?<span class=w> </span><span class=o>(</span>y/N<span class=o>)</span><span class=w> </span>y
gpg&gt;<span class=w> </span>quit
</code></pre></div> </details> </p> <h3 id=8-copy-the-gpgconf-settings-you-need>8. Copy the <code>gpg.conf</code> settings you need<a class=headerlink href=#8-copy-the-gpgconf-settings-you-need title="Permanent link">#</a></h3> <p>Earlier in this howto, you edited a gpg.conf file in your mounted encrypted drive. You should copy that file (or it's contents) into the gpg.conf file in your ~/.gnupg directory.</p> <div class=highlight><pre><span></span><code>cp<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/gpg.conf<span class=w> </span>~/.gnupg/
</code></pre></div> <h3 id=9-ensure-proper-options-are-set-in-gpg-agentconf>9. Ensure proper options are set in <code>gpg-agent.conf</code><a class=headerlink href=#9-ensure-proper-options-are-set-in-gpg-agentconf title="Permanent link">#</a></h3> <p>Ensure proper options are set in <code>gpg-agent.conf</code></p> <p> <details> <summary>Linux</summary> <div class=highlight><pre><span></span><code>cat<span class=w> </span><span class=s>&lt;&lt; EOF &gt; ~/.gnupg/gpg-agent.conf</span>
<span class=s>default-cache-ttl 600</span>
<span class=s>max-cache-ttl 7200</span>
<span class=s>pinentry-program /usr/bin/pinentry</span>
<span class=s>enable-ssh-support</span>
<span class=s>EOF</span>
</code></pre></div> </details> </p> <p> <details> <summary>MacOS</summary> <div class=highlight><pre><span></span><code>cat<span class=w> </span><span class=s>&lt;&lt; EOF &gt; ~/.gnupg/gpg-agent.conf</span>
<span class=s>default-cache-ttl 600</span>
<span class=s>max-cache-ttl 7200</span>
<span class=s>pinentry-program /usr/local/bin/pinentry-mac</span>
<span class=s>enable-ssh-support</span>
<span class=s>EOF</span>
</code></pre></div> </details> </p> <p>Ensure proper options are set in <code>scdaemon.conf</code></p> <p> <details> <summary>Linux & MacOS</summary> <div class=highlight><pre><span></span><code>cat<span class=w> </span><span class=s>&lt;&lt; EOF &gt; ~/.gnupg/scdaemon.conf</span>
<span class=s>reader-port Yubico Yubi</span>
<span class=s>disable-ccid</span>
<span class=s>EOF</span>
</code></pre></div> </details> </p> <p>Ensure your environment knows how to authenticate SSH</p> <p> <details> <summary>MacOS</summary> <div class=highlight><pre><span></span><code><span class=nb>export</span><span class=w> </span><span class=nv>SSH_AUTH_SOCK</span><span class=o>=</span><span class=nv>$HOME</span>/.gnupg/S.gpg-agent.ssh
</code></pre></div> </details> </p> <p> <details> <summary>Linux</summary> <div class=highlight><pre><span></span><code><span class=nb>unset</span><span class=w> </span>SSH_AGENT_PID
<span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=s2>&quot;</span><span class=si>${</span><span class=nv>gnupg_SSH_AUTH_SOCK_by</span><span class=k>:-</span><span class=nv>0</span><span class=si>}</span><span class=s2>&quot;</span><span class=w> </span>-ne<span class=w> </span><span class=nv>$$</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<span class=w>  </span><span class=nb>export</span><span class=w> </span><span class=nv>SSH_AUTH_SOCK</span><span class=o>=</span><span class=s2>&quot;</span><span class=k>$(</span>gpgconf<span class=w> </span>--list-dirs<span class=w> </span>agent-ssh-socket<span class=k>)</span><span class=s2>&quot;</span>
<span class=k>fi</span>
</code></pre></div> </details> </p> <p>After all the files are changed:</p> <ol> <li> <p>Source the <code>rc</code></p> </li> <li> <p>Remove any automation you might have that starts <code>ssh-agent</code>.</p> </li> </ol> <h3 id=12-script-to-reset-gpg-agent-and-ssh-agent>12. Script to Reset gpg-agent and ssh-agent<a class=headerlink href=#12-script-to-reset-gpg-agent-and-ssh-agent title="Permanent link">#</a></h3> <p> <details> <summary>MacOS</summary> This script will reset `gpg-agent` and `ssh-agent` after you make the above updates to `gpg-agent.conf`. <div class=highlight><pre><span></span><code><span class=ch>#!/bin/bash</span>

<span class=nb>echo</span><span class=w> </span><span class=s2>&quot;kill gpg-agent&quot;</span>
<span class=nv>code</span><span class=o>=</span><span class=m>0</span>
<span class=k>while</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=m>1</span><span class=w> </span>-ne<span class=w> </span><span class=nv>$code</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
<span class=w>    </span>killall<span class=w> </span>gpg-agent
<span class=w>    </span><span class=nv>code</span><span class=o>=</span><span class=nv>$?</span>
<span class=w>    </span>sleep<span class=w> </span><span class=m>1</span>
<span class=k>done</span>

<span class=nb>echo</span><span class=w> </span><span class=s2>&quot;kill ssh&quot;</span>
<span class=w>    </span>killall<span class=w> </span>ssh

<span class=nb>echo</span><span class=w> </span><span class=s2>&quot;kill ssh muxers&quot;</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span>pid<span class=w> </span><span class=k>in</span><span class=w> </span><span class=sb>`</span>ps<span class=w> </span>-ef<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>ssh<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>-v<span class=w> </span>grep<span class=w> </span><span class=p>|</span><span class=w> </span>awk<span class=w> </span><span class=s1>&#39;{print $2}&#39;</span><span class=sb>`</span><span class=p>;</span><span class=w> </span><span class=k>do</span>
<span class=w>    </span><span class=nb>kill</span><span class=w> </span><span class=nv>$pid</span>
<span class=k>done</span>

<span class=nb>echo</span><span class=w> </span><span class=s2>&quot;restart gpg-agent&quot;</span>
<span class=w>    </span><span class=nb>eval</span><span class=w> </span><span class=k>$(</span>gpg-agent<span class=w> </span>--daemon<span class=k>)</span>

<span class=nb>echo</span>
<span class=nb>echo</span><span class=w> </span><span class=s2>&quot;All done. Now unplug / replug the NEO token.&quot;</span>
<span class=nb>echo</span>
</code></pre></div> </details> </p> <p> <details> <summary>Linux</summary> Reload the `gpg-agent --daemon` with the following: `gpg-connect-agent reloadagent /bye` </details> </p> <h3 id=13-export-your-ssh-public-key>13. Export Your SSH Public Key<a class=headerlink href=#13-export-your-ssh-public-key title="Permanent link">#</a></h3> <p>This generates a public key that you can paste into GitLab or use as a public key for SSH access to systems via Chef.</p> <p> <details> <summary>How to export the SSH public key</summary> <div class=highlight><pre><span></span><code>&gt;<span class=w> </span>gpg<span class=w> </span>--export-ssh-key<span class=w> </span>FAEFD87E
ssh-rsa<span class=w> </span>AAAAB3NzaC1yc2EAAAADAQABA<span class=w> </span>...<span class=w> </span>COMMENT
</code></pre></div> </details> </p> <h3 id=14-use-your-gpg-public-key-to-sign-git-commits>14. Use your GPG Public Key to Sign Git Commits<a class=headerlink href=#14-use-your-gpg-public-key-to-sign-git-commits title="Permanent link">#</a></h3> <p>By telling Git and GitLab about your GPG public key, you can sign your Git commits with your Encryption subkey.</p> <p>First, follow the instructions <a href=https://docs.gitlab.com/ee/user/project/repository/gpg_signed_commits/index.html#associate-your-gpg-key-with-git>here</a> to tell Git to sign your commits with your key.</p> <p>Next, we'll associate the key with our GitLab profile.</p> <p> <details> <summary>How to export the GPG public key</summary> <div class=highlight><pre><span></span><code>&gt;<span class=w> </span>gpg<span class=w> </span>--armor<span class=w> </span>--export<span class=w> </span>FAEFD87E
-----BEGIN<span class=w> </span>PGP<span class=w> </span>PUBLIC<span class=w> </span>KEY<span class=w> </span>BLOCK-----

mQINBGMFt1wBEADOZNs6tW...
-----END<span class=w> </span>PGP<span class=w> </span>PUBLIC<span class=w> </span>KEY<span class=w> </span>BLOCK-----
</code></pre></div> Alternatively, if you recall, we had earlier backed this up to our encrypted volume, you can just view the contents of the file you had backed up. <div class=highlight><pre><span></span><code>&gt;<span class=w> </span>cat<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config/FAEFD83E.asc
-----BEGIN<span class=w> </span>PGP<span class=w> </span>PUBLIC<span class=w> </span>KEY<span class=w> </span>BLOCK-----

mQINBGMFt1wBEADOZNs6tW...
-----END<span class=w> </span>PGP<span class=w> </span>PUBLIC<span class=w> </span>KEY<span class=w> </span>BLOCK-----
</code></pre></div> </details> </p> <p>Copy the entire key block including the <code>BEGIN PGP PUBLIC KEY BLOCK</code> and <code>END PGP PUBLIC KEY BLOCK</code> lines.</p> <p>Go to your GitLab.com profile and click on GPG keys in the sidebar. Paste the key block into the input box.</p> <p>Note that this is the <strong>entire</strong> key, including all subkeys, so after submitting the key you should see the key ID of the master key as well as the all key IDs of the signing, encryption and authentication subkeys you made. This is expected.</p> <p>Remember to do this for other GitLab instances too (ops and staging).</p> <h3 id=15-testing>15. Testing<a class=headerlink href=#15-testing title="Permanent link">#</a></h3> <p>Try to sign a message, open an SSH connection to gitlab, and sign an empty commit to check if everything is working.</p> <p> <details> <summary>How to test if everything is working</summary> Try encrypting and signing a message, e.g. to yourself: <div class=highlight><pre><span></span><code>$<span class=w> </span><span class=nb>echo</span><span class=w> </span>foo<span class=w> </span><span class=p>|</span><span class=w> </span>gpg<span class=w> </span>--encrypt<span class=w> </span>--armor<span class=w> </span>--sign<span class=w> </span>--recipient<span class=w> </span>&lt;keyid<span class=w> </span>from<span class=w> </span><span class=sb>`</span>gpg<span class=w> </span>--list-keys<span class=sb>`</span>&gt;
-----BEGIN<span class=w> </span>PGP<span class=w> </span>MESSAGE-----
...
-----END<span class=w> </span>PGP<span class=w> </span>MESSAGE-----
</code></pre></div> Exercise the ssh authentication functionality: <div class=highlight><pre><span></span><code>$<span class=w> </span>ssh-add<span class=w> </span>-l
...<span class=w> </span>your<span class=w> </span>public<span class=w> </span>key<span class=w> </span>...

<span class=c1># Assuming you have added your new public key to your gitlab.com profile</span>
$<span class=w> </span>ssh<span class=w> </span>git@gitlab.com
PTY<span class=w> </span>allocation<span class=w> </span>request<span class=w> </span>failed<span class=w> </span>on<span class=w> </span>channel<span class=w> </span><span class=m>0</span>
Welcome<span class=w> </span>to<span class=w> </span>GitLab,<span class=w> </span>@user!
Connection<span class=w> </span>to<span class=w> </span>gitlab.com<span class=w> </span>closed.
</code></pre></div> Exercise the git commit signing functionality on a throwaway branch: <div class=highlight><pre><span></span><code>git<span class=w> </span>commit<span class=w> </span>--allow-empty<span class=w> </span>-m<span class=w> </span><span class=s2>&quot;Test signing&quot;</span>
</code></pre></div> </details> </p> <h2 id=cleanup>Cleanup<a class=headerlink href=#cleanup title="Permanent link">#</a></h2> <ul> <li>Unmount the encrypted GPG master volume.</li> </ul> <p> <details> <summary>Linux</summary> `sudo veracrypt -d ~/gitlab_secrets` </details> </p> <p> <details> <summary>MacOS</summary> `hdiutil detach /Volumes/GitLab` </details> </p> <ul> <li>Ensure that the backing file for the GPG master volume is backed up, e.g. copy it to a USB drive.</li> <li>If you have anything that starts up the <code>gpg-agent</code>, ensure the options reflect the work we've accomplished above</li> </ul> <h2 id=maintenance>Maintenance<a class=headerlink href=#maintenance title="Permanent link">#</a></h2> <h3 id=renew-expiring-subkeys>Renew expiring subkeys<a class=headerlink href=#renew-expiring-subkeys title="Permanent link">#</a></h3> <p>Remount your encrypted secrets image using the <code>veracrypt mount</code> or <code>hdiutil attach</code> commands Setup env vars:</p> <div class=highlight><pre><span></span><code>export MOUNTPOINT=/path/to/mountpoint
export GNUPGHOME=$MOUNTPOINT/gpg_config/
</code></pre></div> <p>Optionally take a backup of the original gpg_config, inside your encrypted volume (size is tiny, it's a small price to pay)</p> <div class=highlight><pre><span></span><code>cp<span class=w> </span>-r<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config<span class=w> </span><span class=nv>$MOUNTPOINT</span>/gpg_config.<span class=k>$(</span>date<span class=w> </span>+%Y-%m-%d<span class=k>)</span>.bak
</code></pre></div> <p> <details> <summary>Renew the sub keys</summary> Edit the key: <div class=highlight><pre><span></span><code>$<span class=w> </span>gpg<span class=w> </span>--edit-key<span class=w> </span>&lt;youremail&gt;
<span class=c1># Ensure that after the boilerplate license it reports &quot;Secret key is available&quot;,</span>
<span class=c1># and not &quot;Secret subkeys are available&quot;.  The former means you correctly have access</span>
<span class=c1># to the master key/secret, the latter means you&#39;re using your exported sub-keys</span>
<span class=c1># (you probably still have your gpg pointing at $HOME/.gnupg; check $GNUPGHOME is set</span>
<span class=c1># per above).</span>
<span class=c1># Select the 3 sub keys (signature, authentication, encryption):</span>

gpg&gt;<span class=w> </span>key<span class=w> </span><span class=m>1</span>

pub<span class=w>  </span>4096R/FAEFD83E<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2023</span>-08-25<span class=w>  </span>usage:<span class=w> </span>C
<span class=w>                     </span>trust:<span class=w> </span>ultimate<span class=w>      </span>validity:<span class=w> </span>ultimate
sub*<span class=w> </span>4096R/AE86E89B<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>E
sub<span class=w>  </span>4096R/79BF274F<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>S
sub<span class=w>  </span>4096R/DE86E396<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>A

gpg&gt;<span class=w> </span>key<span class=w> </span><span class=m>2</span>

pub<span class=w>  </span>4096R/FAEFD83E<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2023</span>-08-25<span class=w>  </span>usage:<span class=w> </span>C
<span class=w>                     </span>trust:<span class=w> </span>ultimate<span class=w>      </span>validity:<span class=w> </span>ultimate
sub*<span class=w> </span>4096R/AE86E89B<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>E
sub*<span class=w> </span>4096R/79BF274F<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>S
sub<span class=w>  </span>4096R/DE86E396<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>A

gpg&gt;<span class=w> </span>key<span class=w> </span><span class=m>3</span>

pub<span class=w>  </span>4096R/FAEFD83E<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2023</span>-08-25<span class=w>  </span>usage:<span class=w> </span>C
<span class=w>                     </span>trust:<span class=w> </span>ultimate<span class=w>      </span>validity:<span class=w> </span>ultimate
sub*<span class=w> </span>4096R/AE86E89B<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>E
sub*<span class=w> </span>4096R/79BF274F<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>S
sub*<span class=w> </span>4096R/DE86E396<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2018</span>-08-25<span class=w>  </span>usage:<span class=w> </span>A
<span class=c1># You should see an asterisk appear next to a sub key  after each `key` command,</span>
<span class=c1># and have 3 of them starred at the end.</span>
<span class=c1># Update the expiry key with the (distressingly named) `expire` command:</span>

gpg&gt;<span class=w> </span>expire
Are<span class=w> </span>you<span class=w> </span>sure<span class=w> </span>you<span class=w> </span>want<span class=w> </span>to<span class=w> </span>change<span class=w> </span>the<span class=w> </span>expiration<span class=w> </span><span class=nb>time</span><span class=w> </span><span class=k>for</span><span class=w> </span>multiple<span class=w> </span>subkeys?<span class=w> </span><span class=o>(</span>y/N<span class=o>)</span><span class=w> </span>y
Please<span class=w> </span>specify<span class=w> </span>how<span class=w> </span>long<span class=w> </span>the<span class=w> </span>key<span class=w> </span>should<span class=w> </span>be<span class=w> </span>valid.
<span class=w>         </span><span class=nv>0</span><span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>does<span class=w> </span>not<span class=w> </span>expire
<span class=w>      </span>&lt;n&gt;<span class=w>  </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>days
<span class=w>      </span>&lt;n&gt;w<span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>weeks
<span class=w>      </span>&lt;n&gt;m<span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>months
<span class=w>      </span>&lt;n&gt;y<span class=w> </span><span class=o>=</span><span class=w> </span>key<span class=w> </span>expires<span class=w> </span><span class=k>in</span><span class=w> </span>n<span class=w> </span>years
Key<span class=w> </span>is<span class=w> </span>valid<span class=w> </span><span class=k>for</span>?<span class=w> </span><span class=o>(</span><span class=m>0</span><span class=o>)</span><span class=w> </span>13m
<span class=c1># Enter how long the keys should be valid for *from now*; typically use 12-13 months (12m or 13m),</span>
<span class=c1># aiming for ~1 year past the previous expiry but taking care to avoid creeping forward or</span>
<span class=c1># backward into common annual holiday periods in your country.</span>
Key<span class=w> </span>expires<span class=w> </span>at<span class=w> </span>Sun<span class=w> </span>Aug<span class=w>  </span><span class=m>25</span><span class=w> </span><span class=m>01</span>:21:41<span class=w> </span><span class=m>2019</span><span class=w> </span>CST
Is<span class=w> </span>this<span class=w> </span>correct?<span class=w> </span><span class=o>(</span>y/N<span class=o>)</span><span class=w> </span>y
<span class=c1># Verify the expiry date is what you expect, and if so, type &#39;y&#39;</span>

pub<span class=w>  </span>4096R/FAEFD83E<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2023</span>-08-25<span class=w>  </span>usage:<span class=w> </span>C
<span class=w>                     </span>trust:<span class=w> </span>ultimate<span class=w>      </span>validity:<span class=w> </span>ultimate
sub*<span class=w> </span>4096R/AE86E89B<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2019</span>-08-25<span class=w>  </span>usage:<span class=w> </span>E
sub*<span class=w> </span>4096R/79BF274F<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2019</span>-08-25<span class=w>  </span>usage:<span class=w> </span>S
sub*<span class=w> </span>4096R/DE86E396<span class=w>  </span>created:<span class=w> </span><span class=m>2017</span>-08-25<span class=w>  </span>expires:<span class=w> </span><span class=m>2019</span>-08-25<span class=w>  </span>usage:<span class=w> </span>A
<span class=c1># save and exit</span>
gpg&gt;<span class=w> </span>save
gpg&gt;<span class=w> </span>quit
</code></pre></div> Export the updated key information: <div class=highlight><pre><span></span><code>gpg --armor --export FAEFD83E &gt; $MOUNTPOINT/gpg_config/FAEFD83E.asc
</code></pre></div> From a fresh terminal (using your normal ~/.gnupg GPG directory: <div class=highlight><pre><span></span><code>gpg --import $MOUNTPOINT/gpg_config/FAEFD83E.asc
</code></pre></div> Unmount your encrypted volume, re-copy the image file to your external safe storage (e.g. USB flash drive) </details> </p> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">#</a></h2> <h3 id=gpg-cannot-find-the-yubikey>GPG cannot find the Yubikey<a class=headerlink href=#gpg-cannot-find-the-yubikey title="Permanent link">#</a></h3> <p>This problem can manifest itself in a few ways:</p> <ul> <li>Pinentry asking you to insert a SmartCard when it is already inserted</li> <li>GPG failing to encrypt or sign messages</li> <li>SSH failing to authenticate</li> <li>No SSH keys visible with <code>ssh-add -l</code></li> </ul> <p>The solution is to "kick" gpg-agent into checking for a SmartCard by running <code>gpg --card-status</code>.</p> <p>If you run gpg --card-status with the YubiKey plugged in and GPG does not detect the YubiKey, try the steps below:</p> <ul> <li>Specify the smart card reader GPG uses by adding the line <code>reader-port Yubico Yubi</code> to the scdaemon.conf file; create the file if it does not exist. After making this change, reboot your computer to ensure it takes affect.</li> <li>On macOS and Linux it is at: ~/.gnupg/scdaemon.conf</li> <li>On macOS or Linux, you may need to add "reader-port Yubico Yubikey" (with a lowercase K) instead of what is above if you are using a YubiKey 4 Series or NEO</li> </ul> <h3 id=ssh-connections-hang>ssh connections hang<a class=headerlink href=#ssh-connections-hang title="Permanent link">#</a></h3> <p>add <code>disable-ccid</code> to <code>~/.gnupg/scdaemon.conf</code> and use the restart script to restart <code>gpg-agent</code> (which manages scdaemon)</p> <h3 id=unable-to-sign-commits-with-backup-yubikey>Unable to sign commits with backup YubiKey<a class=headerlink href=#unable-to-sign-commits-with-backup-yubikey title="Permanent link">#</a></h3> <p>If you have configured subkeys on a second, backup YubiKey, you must append a <code>!</code> after the <code>keyid</code> specified for the <code>user.signingkey</code> config attribute in <code>~/.gitconfig</code>, before git will use the new signing key. Otherwise git will continue to prompt for the last written YubiKey, regardless of which <code>keyid</code> is specified. For additional context, see <a href=https://github.com/drduh/YubiKey-Guide/issues/19#issuecomment-1143557632>this github issue comment</a>.</p> <h3 id=resetting-your-yubikey>Resetting your yubikey<a class=headerlink href=#resetting-your-yubikey title="Permanent link">#</a></h3> <p>If you run into an issue (such as entering the wrong PIN too many times) you can hard reset your key using <code>gpg --card-edit</code>. More information at <a href=https://support.yubico.com/hc/en-us/articles/360013761339-Resetting-the-OpenPGP-Application-on-the-YubiKey>Yubico docs</a>, option <a class="magiclink magiclink-github magiclink-issue" href=https://github.com/squidfunk/mkdocs-material/issues/2 title="GitHub Issue: squidfunk/mkdocs-material #2">#2</a> is recommended.</p> <h2 id=linux-tips>Linux tips<a class=headerlink href=#linux-tips title="Permanent link">#</a></h2> <h3 id=gpg-selecting-openpgp-failed-no-such-device>gpg: selecting openpgp failed: No such device<a class=headerlink href=#gpg-selecting-openpgp-failed-no-such-device title="Permanent link">#</a></h3> <p>On recent Ubuntu/Mint releases (18.04+), GPG has a lot of quality-of-life enhancements, which have just bit you in the butt. When you run gpg with a 'new' GNUPGHOME value, a dir is created in /run/user/<uid>/gnupg/, based in what looks to be a hash of the value of GNUPGHOME, and agents stated (gpg-agent, scdaemon, at least) with sockets in that directory, so there can be multiple running at once. You've got this message because the scdaemon that you're accessing (via its socket) is not the one that has ownership of the Yubikey right now. You can release the other one by executing</p> <div class=highlight><pre><span></span><code>gpg-connect-agent<span class=w> </span><span class=s2>&quot;SCD KILLSCD&quot;</span><span class=w> </span><span class=s2>&quot;SCD BYE&quot;</span><span class=w> </span>/bye
</code></pre></div> <p>with GNUPGHOME set to the path of the instance that currently owns the card that you want to go away. A simple 'kill' will not cause scdaemon to exit, and this is nicer than doing a kill -9. You could also just kill (SIGTERM) the gpg-agent for the undesired GNUPGHOME, which will close all the things down for that config.</p> <p><strong>Note</strong> GPG does <em>not</em> normalize the value of $GNUPGHOME to a path, so /media/Gitlab/gpg_config is not the same as /media/Gitlab//gpg_config (two slashes) and each will have its own directory and set of agents/sockets. This is lightly surprising, and can be very confusing.</p> <h3 id=linux-mint-gtk2-pinentry>Linux Mint (GTK2) + Pinentry<a class=headerlink href=#linux-mint-gtk2-pinentry title="Permanent link">#</a></h3> <p>Noted on Mint 19 Mate edition, because it's GTK2 and the default pinentry install was for GNOME3, but may apply elsewhere:</p> <div class=highlight><pre><span></span><code>sudo<span class=w> </span>apt<span class=w> </span>install<span class=w> </span>pinentry-gtk2
sudo<span class=w> </span>update-alternatives<span class=w> </span>--set<span class=w> </span>pinentry<span class=w> </span>/usr/bin/pinentry-gtk-2
</code></pre></div> <p>Otherwise it falls back to curses, and picks whichever terminal/PTY it thinks is right (probably where you last tickled gpg-agent from), which is usually horribly wrong or dead. It is also possible to explicitly call the binary as pinentry-program in gpg-agent.conf, but update-alternatives is a bit more blessed/proper for the Debian ecosystem.</p> <p><code>gpg-connect-agent updatestartuptty /bye</code> can help too, but only temporarily (it'll set the TTY to the terminal where this command is run). You could do this if you like the TTY/curses pin prompt, perhaps in an alias</p> <h2 id=reference-material>Reference Material<a class=headerlink href=#reference-material title="Permanent link">#</a></h2> <ul> <li><a href=https://github.com/drduh/YubiKey-Guide#21-install---linux>https://github.com/drduh/YubiKey-Guide#21-install---linux</a></li> <li><a href=https://wiki.archlinux.org/index.php/GnuPG>https://wiki.archlinux.org/index.php/GnuPG</a></li> </ul> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> &copy; 2021 ivanka </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/ivankatliarchuk target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://github.com/ivankatliarchuk target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://hub.docker.com/r/cloudkats target=_blank rel=noopener title=hub.docker.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg> </a> <a href=https://www.hackerrank.com/tanzwud target=_blank rel=noopener title=www.hackerrank.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M477.5 128C463 103.05 285.13 0 256.16 0S49.25 102.79 34.84 128s-14.49 230.8 0 256 192.38 128 221.32 128S463 409.08 477.49 384s14.51-231 .01-256zM316.13 414.22c-4 0-40.91-35.77-38-38.69.87-.87 6.26-1.48 17.55-1.83 0-26.23.59-68.59.94-86.32 0-2-.44-3.43-.44-5.85h-79.93c0 7.1-.46 36.2 1.37 72.88.23 4.54-1.58 6-5.74 5.94-10.13 0-20.27-.11-30.41-.08-4.1 0-5.87-1.53-5.74-6.11.92-33.44 3-84-.15-212.67v-3.17c-9.67-.35-16.38-1-17.26-1.84-2.92-2.92 34.54-38.69 38.49-38.69s41.17 35.78 38.27 38.69c-.87.87-7.9 1.49-16.77 1.84v3.16c-2.42 25.75-2 79.59-2.63 105.39h80.26c0-4.55.39-34.74-1.2-83.64-.1-3.39.95-5.17 4.21-5.2 11.07-.08 22.15-.13 33.23-.06 3.46 0 4.57 1.72 4.5 5.38C333 354.64 336 341.29 336 373.69c8.87.35 16.82 1 17.69 1.84 2.88 2.91-33.62 38.69-37.58 38.69z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.indexes", "search.suggest", "search.highlight", "search.share", "tabs", "tags", "toc.integrate", "toc.follow", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.bd41221c.min.js></script> </body> </html>